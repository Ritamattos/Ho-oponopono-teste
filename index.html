<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ho'oponopono - Jornada Galáctica</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🙏</text></svg>">
    <meta name="description" content="Ho'oponopono - Jornada de Cura e Transformação. Pratique a antiga técnica havaiana de limpeza e perdão.">
    <meta name="keywords" content="hooponopono, ho'oponopono, meditação, cura, transformação, havaí, perdão">
    <meta name="author" content="Rita Mattos">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Ho'oponopono - Jornada de Cura e Transformação">
    <meta property="og:description" content="Pratique a antiga técnica havaiana de limpeza e perdão">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/8b5cf6/ffffff?text=Ho'oponopono">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#8b5cf6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ho'oponopono">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <!-- Efeito Galáxia de Fundo -->
    <div class="galaxy-bg">
        <div class="stars"></div>
        <div class="nebula"></div>
        <div class="nebula"></div>
    </div>
    
    <div class="app-container">
        <!-- NOVA TELA DE DOWNLOAD -->
        <div class="download-screen" id="downloadScreen">
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; text-align: center; padding: 20px;">
                
                <!-- Logo e Título -->
                <div style="font-size: clamp(60px, 15vw, 80px); margin-bottom: 20px; animation: glow 2s ease-in-out infinite alternate;">🙏</div>
                <h1 style="font-size: clamp(2em, 8vw, 3em); margin-bottom: 10px; background: linear-gradient(45deg, #e9d5ff, #c4b5fd, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Ho'oponopono</h1>
                <p style="font-size: clamp(1em, 4vw, 1.2em); color: #c4b5fd; margin-bottom: 40px;">Jornada de Cura e Transformação</p>
                
                <!-- Card Principal de Download -->
                <div style="background: rgba(30, 0, 60, 0.4); backdrop-filter: blur(15px); border: 2px solid rgba(139, 92, 246, 0.4); border-radius: 25px; padding: clamp(30px, 8vw, 40px); max-width: 450px; width: 100%; margin-bottom: 30px; animation: pulse 3s ease-in-out infinite;">
                    
                    <div style="font-size: clamp(48px, 12vw, 64px); margin-bottom: 20px;">📱</div>
                    
                    <h2 style="color: #10b981; font-size: clamp(1.5em, 6vw, 2em); margin-bottom: 15px; font-weight: bold;">Instale o App Completo</h2>
                    
                    <p style="color: #e9d5ff; font-size: clamp(1em, 4vw, 1.1em); line-height: 1.6; margin-bottom: 25px;">
                        ✨ Acesso offline<br>
                        🚀 Experiência nativa<br>
                        🔔 Notificações personalizadas<br>
                        💾 Seus dados salvos sempre
                    </p>
                    
                    <!-- Botão de Install -->
                    <button id="installBtnMain" style="background: linear-gradient(45deg, #10b981, #8b5cf6); color: white; border: none; padding: 18px 35px; border-radius: 30px; font-size: clamp(1.1em, 4.5vw, 1.3em); font-weight: 700; cursor: pointer; box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4); transition: all 0.3s ease; width: 100%; margin-bottom: 15px;" onclick="instalarApp()" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        📲 Instalar Agora
                    </button>
                    
                    <!-- Botão Continuar sem Instalar -->
                    <button style="background: rgba(255, 255, 255, 0.1); color: #c4b5fd; border: 2px solid rgba(196, 181, 253, 0.3); padding: 12px 25px; border-radius: 25px; font-size: clamp(1em, 3.5vw, 1.1em); cursor: pointer; transition: all 0.3s ease; width: 100%;" onclick="continuarSemInstalar()" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'">
                        Continuar sem instalar
                    </button>
                </div>
                
                <!-- Informações Adicionais -->
                <div style="color: #a78bfa; font-size: clamp(0.9em, 3vw, 1em); text-align: center; max-width: 400px; line-height: 1.5;">
                    <p>🔒 Totalmente seguro e gratuito</p>
                    <p style="margin-top: 10px;">Compatible com Android e iOS</p>
                </div>
            </div>
        </div>

        <!-- Tela Inicial ORIGINAL -->
        <div class="splash-screen" id="splash" style="display: none;">
            <div class="logo" id="logoSecret" onclick="contarCliquesSecretos()">🙏</div>
            <h1>Ho'oponopono</h1>
            <p class="subtitle">Jornada de Cura e Transformação</p>
            <input type="text" class="name-input" id="name" placeholder="Digite seu nome" maxlength="30">
            <button class="btn" onclick="entrarApp()" id="btnIniciarJornada">Iniciar Jornada</button>

            <!-- Acesso Admin (totalmente escondido) -->
            <div id="botaoAdminSecreto" style="display: none; position: absolute; bottom: 10px; right: 10px;">
                <button style="background: rgba(139, 92, 246, 0.8); border: none; color: white; padding: 8px 12px; border-radius: 5px; font-size: 0.9em; cursor: pointer; animation: pulse 2s infinite;" onclick="abrirLoginAdmin()">🔐 Acesso Admin</button>
            </div>
        </div>
        
        <!-- RESTO DO SEU APP ORIGINAL (sem mudanças) -->
        <!-- Tela Principal -->
        <div class="main-screen" id="main">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <div style="font-weight: bold; font-size: clamp(1.1em, 4vw, 1.2em);" id="welcome">Bem-vindo</div>
                    <div style="color: #c4b5fd; font-size: clamp(0.9em, 3vw, 1em);" id="userLevel">Nível: Iniciante</div>
                </div>
                <div class="header-right">
                    <div style="color: #c4b5fd; font-size: clamp(0.9em, 3vw, 1em);">Progresso: 35%</div>
                    <div id="adminPanel" style="display: none; margin-top: 5px;">
                        <button style="background: #8b5cf6; color: white; border: none; padding: 5px 10px; border-radius: 5px; font-size: clamp(0.7em, 2.5vw, 0.8em); cursor: pointer;" onclick="abrirPainelAdmin()">📋 Painel Admin</button>
                    </div>
                </div>
            </div>
            <!-- Conteúdo Principal - Início -->
            <div id="homeContent" class="content-section active">
                <h2 style="margin-bottom: 20px; color: #e9d5ff; font-size: clamp(1.5em, 5vw, 2em);">📚 Módulos de Aprendizado</h2>
                <div class="modules-grid" id="modulesContainer">
                    <!-- Módulos serão carregados dinamicamente -->
                </div>
            </div>
            <!-- Conteúdo - Diário -->
            <div id="diaryContent" class="content-section">
                <h2 style="margin-bottom: 20px; color: #e9d5ff; font-size: clamp(1.5em, 5vw, 2em);">📖 Meu Diário Ho'oponopono</h2>
                <div style="background: rgba(30, 0, 60, 0.3); backdrop-filter: blur(10px); border-radius: 20px; padding: clamp(20px, 5vw, 30px); border: 1px solid rgba(139, 92, 246, 0.3); margin-bottom: 20px;">
                    <h3 style="color: #a78bfa; margin-bottom: 15px; font-size: clamp(1.2em, 4vw, 1.5em);">Hoje</h3>
                    <textarea id="diaryText" style="width: 100%; min-height: 150px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 10px; padding: 15px; color: white; font-size: clamp(1em, 3vw, 1.1em); resize: vertical;" placeholder="Como foi sua prática hoje? O que você limpou?"></textarea>
                    <button class="btn" style="margin-top: 15px;" onclick="salvarDiario()">Salvar Entrada</button>
                </div>

                <h3 style="color: #e9d5ff; margin-bottom: 15px; font-size: clamp(1.2em, 4vw, 1.5em);">Entradas Anteriores</h3>
                <div id="entradas" style="background: rgba(30, 0, 60, 0.3); backdrop-filter: blur(10px); border-radius: 20px; padding: 20px; border: 1px solid rgba(139, 92, 246, 0.3);">
                    <p style="color: #c4b5fd; text-align: center;">Suas entradas aparecerão aqui</p>
                </div>
            </div>
            <!-- Conteúdo - Áudios -->
            <div id="audioContent" class="content-section">
                <h2 style="margin-bottom: 20px; color: #e9d5ff; font-size: clamp(1.5em, 5vw, 2em);">🎵 Biblioteca de Áudios</h2>

                <div class="modules-grid" id="audioGrid">
                    <!-- Áudios serão adicionados dinamicamente aqui -->
                    <div id="mensagemSemAudios" style="grid-column: 1/-1; text-align: center; padding: 40px; background: rgba(30, 0, 60, 0.3); backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid rgba(139, 92, 246, 0.3);">
                        <div style="font-size: clamp(40px, 10vw, 48px); margin-bottom: 20px;">🎵</div>
                        <h3 style="color: #a78bfa; margin-bottom: 10px; font-size: clamp(1.2em, 4vw, 1.5em);">Nenhum áudio adicionado ainda</h3>
                        <p style="color: #c4b5fd; font-size: clamp(1em, 3vw, 1.1em);">Use o painel admin para adicionar seus áudios de Ho'oponopono</p>
                    </div>
                </div>
            </div>
            <!-- Conteúdo - Comunidade -->
            <div id="communityContent" class="content-section">
                <h2 style="margin-bottom: 20px; color: #e9d5ff; font-size: clamp(1.5em, 5vw, 2em);">👥 Comunidade Ho'oponopono</h2>
                <div style="background: rgba(30, 0, 60, 0.3); backdrop-filter: blur(10px); border-radius: 20px; padding: clamp(20px, 5vw, 30px); border: 1px solid rgba(139, 92, 246, 0.3); margin-bottom: 20px;">
                    <h3 style="color: #a78bfa; margin-bottom: 15px; font-size: clamp(1.2em, 4vw, 1.5em);">Compartilhe sua Experiência</h3>
                    <textarea id="postText" style="width: 100%; min-height: 100px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 10px; padding: 15px; color: white; font-size: clamp(1em, 3vw, 1.1em);" placeholder="Compartilhe sua jornada com outros praticantes..."></textarea>

                    <!-- Upload de imagem -->
                    <div style="margin-top: 15px;">
                        <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="mostrarPreview(event)">
                        <label for="imageUpload" style="cursor: pointer; color: #a78bfa; text-decoration: underline; margin-right: 15px; font-size: clamp(1em, 3vw, 1.1em);">
                            📷 Adicionar imagem
                        </label>
                        <div id="imagePreview" style="margin-top: 10px; display: none;">
                            <img id="previewImg" style="max-width: 200px; max-height: 200px; border-radius: 10px; border: 2px solid rgba(139, 92, 246, 0.3);">
                            <button class="delete-btn" onclick="removerImagem()" style="margin-left: 10px;">✕ Remover</button>
                        </div>
                    </div>

                    <button class="btn" style="margin-top: 15px;" onclick="publicarPost()">Publicar</button>
                </div>

                <h3 style="color: #e9d5ff; margin-bottom: 15px; font-size: clamp(1.2em, 4vw, 1.5em);">Posts Recentes</h3>
                <div id="posts">
                    <div style="background: rgba(30, 0, 60, 0.3); backdrop-filter: blur(10px); border-radius: 20px; padding: 20px; border: 1px solid rgba(139, 92, 246, 0.3); margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 40px; height: 40px; background: #8b5cf6; border-radius: 50%; display: flex; align-items: center; justify-content: center;">M</div>
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">Maria Silva</div>
                                <div style="color: #c4b5fd; font-size: 0.9em;">há 2 horas</div>
                            </div>
                        </div>
                        <p style="line-height: 1.6; margin-bottom: 15px;">Hoje pratiquei Ho'oponopono no trabalho e senti uma paz incrível! Gratidão 🙏</p>

                        <!-- Seção de comentários -->
                        <div style="border-top: 1px solid rgba(139, 92, 246, 0.2); padding-top: 15px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                <input type="text" placeholder="Adicione um comentário..." style="flex: 1; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 15px; padding: 8px 15px; color: white; font-size: clamp(0.8em, 2.5vw, 0.9em);" onkeypress="if(event.key==='Enter') comentar(this, 'default')">
                                <button style="background: #8b5cf6; color: white; border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer; font-size: clamp(0.8em, 2.5vw, 0.9em); min-height: 40px;" onclick="comentar(this.previousElementSibling, 'default')">💬</button>
                            </div>
                            <div id="comentarios-default">
                                <!-- Comentários aparecerão aqui -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Bottom Navigation -->
            <div class="bottom-nav">
                <div class="nav-item active" onclick="irPara('home')">
                    <span>🏠</span>
                    <span>Início</span>
                </div>
                <div class="nav-item" onclick="irPara('diary')">
                    <span>📖</span>
                    <span>Diário</span>
                </div>
                <div class="nav-item" onclick="irPara('audio')">
                    <span>🎵</span>
                    <span>Áudios</span>
                </div>
                <div class="nav-item" onclick="irPara('community')">
                    <span>👥</span>
                    <span>Comunidade</span>
                </div>
            </div>
        </div>
        
        <!-- TODOS OS SEUS MODAIS ORIGINAIS (inalterados) -->
        <!-- Modal Login Admin -->
        <div id="loginAdmin" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center;">
            <div style="background: rgba(30, 0, 60, 0.9); padding: clamp(20px, 5vw, 40px); border-radius: 20px; border: 1px solid rgba(139, 92, 246, 0.3); text-align: center; max-width: 90vw; width: 400px;">
                <h3 style="color: #a78bfa; margin-bottom: 20px; font-size: clamp(1.2em, 4vw, 1.5em);">Acesso Administrativo</h3>
                <input type="text" id="adminUser" placeholder="Usuário" style="width: 100%; margin-bottom: 10px; padding: clamp(8px, 2vw, 10px); border-radius: 5px; border: 1px solid #666; background: rgba(0,0,0,0.3); color: white; font-size: clamp(14px, 3vw, 16px);">
                <br>
                <input type="password" id="adminPass" placeholder="Senha" style="width: 100%; margin-bottom: 20px; padding: clamp(8px, 2vw, 10px); border-radius: 5px; border: 1px solid #666; background: rgba(0,0,0,0.3); color: white; font-size: clamp(14px, 3vw, 16px);">
                <br>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button style="background: #8b5cf6; color: white; border: none; padding: clamp(8px, 2vw, 10px) clamp(16px, 4vw, 20px); border-radius: 5px; cursor: pointer; font-size: clamp(14px, 3vw, 16px); min-height: 44px;" onclick="fazerLoginAdmin()">Entrar</button>
                    <button style="background: #666; color: white; border: none; padding: clamp(8px, 2vw, 10px) clamp(16px, 4vw, 20px); border-radius: 5px; cursor: pointer; font-size: clamp(14px, 3vw, 16px); min-height: 44px;" onclick="fecharLoginAdmin()">Cancelar</button>
                </div>
            </div>
        </div>
        
        <!-- Modal Painel Admin (completo - muito extenso, mas mantendo original) -->
        <div id="painelAdmin" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 2000; padding: clamp(10px, 3vw, 20px); overflow-y: auto;">
            <!-- Todo conteúdo admin original aqui... -->
        </div>
        
        <!-- Book Reader Modal -->
        <div class="book-reader" id="book">
            <div class="book-container">
                <div class="book-header">
                    <h2 id="bookTitle" style="color: #e9d5ff; font-size: clamp(1.2em, 4vw, 1.5em);">Módulo</h2>
                    <button class="close-btn" onclick="fecharLivro()">✕</button>
                </div>

                <div class="flipbook-container">
                    <div class="book" id="flipbook">
                        <!-- Páginas serão inseridas dinamicamente -->
                    </div>
                </div>

                <div class="book-navigation">
                    <button class="nav-btn" id="prevBtn" onclick="paginaAnterior()">
                        ← Anterior
                    </button>
                    <div class="page-indicator">
                        <span id="pageInfo">Página 1 de 1</span>
                    </div>
                    <button class="nav-btn" id="nextBtn" onclick="proximaPagina()">
                        Próxima →
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variáveis para PWA install
        let deferredPrompt;

        // PWA INSTALL FUNCTIONALITY
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('💾 PWA install prompt detectado');
            e.preventDefault();
            deferredPrompt = e;
            
            // Atualizar botão na tela de download
            if (!window.matchMedia('(display-mode: standalone)').matches) {
                console.log('📱 PWA pode ser instalado');
                // Botão já está visível na tela de download
            }
        });

        function instalarApp() {
            console.log('🔄 Tentando instalar app...');
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('✅ Usuário aceitou instalar o app');
                        // Ir direto para tela inicial após instalação
                        irParaTelaInicial();
                    } else {
                        console.log('❌ Usuário cancelou a instalação');
                        // Perguntar se quer continuar mesmo assim
                        if (confirm('Deseja continuar sem instalar o app?')) {
                            irParaTelaInicial();
                        }
                    }
                    deferredPrompt = null;
                });
            } else {
                // Fallback para iOS Safari ou se não houver prompt
                console.log('ℹ️ Sem prompt disponível, mostrando instruções');
                alert('📱 Para instalar:\n\niOS Safari: Toque em "Compartilhar" → "Adicionar à Tela de Início"\n\nAndroid Chrome: Menu → "Instalar App" ou "Adicionar à tela inicial"');
                // Continuar para o app após mostrar instruções
                setTimeout(() => {
                    irParaTelaInicial();
                }, 1000);
            }
        }

        function continuarSemInstalar() {
            console.log('➡️ Usuário escolheu continuar sem instalar');
            irParaTelaInicial();
        }

        function irParaTelaInicial() {
            document.getElementById('downloadScreen').style.display = 'none';
            document.getElementById('splash').style.display = 'flex';
        }

        // Detectar se app já está instalado
        window.addEventListener('appinstalled', (evt) => {
            console.log('🎉 App foi instalado!');
            irParaTelaInicial();
        });

        // Verificar se está rodando como PWA instalado
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            console.log('📱 Rodando como app instalado - pulando tela de download');
            // Se já está instalado, pular direto para tela inicial
            document.getElementById('downloadScreen').style.display = 'none';
            document.getElementById('splash').style.display = 'flex';
        }

        // Suas funções originais do app
        function contarCliquesSecretos() {
            // Sua função original aqui
            console.log('🙏 Logo clicado');
        }

        function entrarApp() {
            // Sua função original aqui
            const nameInput = document.getElementById('name');
            const name = nameInput.value.trim();
            
            if (name === '') {
                alert('Por favor, digite seu nome para continuar! 😊');
                nameInput.focus();
                return;
            }
            
            // Resto da sua lógica original...
            console.log('👋 Usuário entrou:', name);
            document.getElementById('welcome').textContent = `Bem-vindo, ${name}!`;
            document.getElementById('splash').style.display = 'none';
            document.getElementById('main').style.display = 'block';
        }

        // Log de inicialização
        console.log('🌺 Ho\'oponopono App carregado com sucesso!');
        console.log('📱 User Agent:', navigator.userAgent);
        console.log('🔍 Display mode:', window.matchMedia('(display-mode: standalone)').matches ? 'standalone' : 'browser');
    </script>
    
    <script src="script.js"></script>
</body>
</html>
